(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();class m{constructor(t,e){this.windows=t,this.zIndexCounter=100,this.isDragging=!1,this.currentWindow=null,this.offset={x:0,y:0},this.isResizing=!1,this.currentResizeWindow=null,this.resizeStartSize={width:0,height:0},this.resizeStartMouse={x:0,y:0},this.windowPositions={},this.windowStates={},this.zOrder=[],this.taskbarManager=e,this.openWindows=new Set,this.restoreAllState(),this.init()}saveAllState(){localStorage.setItem("xp-window-positions",JSON.stringify(this.windowPositions)),localStorage.setItem("xp-window-states",JSON.stringify(this.windowStates)),localStorage.setItem("xp-window-zorder",JSON.stringify(this.zOrder))}restoreAllState(){try{const t=localStorage.getItem("xp-window-positions");this.windowPositions=t?JSON.parse(t):{}}catch{this.windowPositions={}}try{const t=localStorage.getItem("xp-window-states");this.windowStates=t?JSON.parse(t):{}}catch{this.windowStates={}}try{const t=localStorage.getItem("xp-window-zorder");this.zOrder=t?JSON.parse(t):[]}catch{this.zOrder=[]}}saveZOrder(){const t=Array.from(this.windows).filter(e=>e.classList.contains("active")&&e.style.display!=="none").sort((e,i)=>parseInt(e.style.zIndex||0)-parseInt(i.style.zIndex||0)).map(e=>e.id.replace("window-",""));this.zOrder=t,this.saveAllState()}restoreZOrder(){if(!this.zOrder||!this.zOrder.length)return;let t=100;this.zOrder.forEach(e=>{const i=document.getElementById("window-"+e);i&&i.classList.contains("active")&&i.style.display!=="none"&&(i.style.zIndex=++t)}),this.zIndexCounter=t}init(){this.windows.forEach((t,e)=>{const i=t.querySelector(".xp-title-bar"),s=t.querySelector(".xp-close-btn"),o=t.querySelector(".xp-minimize-btn"),a=t.querySelector(".xp-maximize-btn"),d=t.querySelector(".xp-resize-handle");i&&i.addEventListener("mousedown",n=>this.startWindowDrag(n,t)),s&&s.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.closeWindow(t)}),o&&o.addEventListener("click",()=>this.minimizeWindow(t)),a&&a.addEventListener("click",()=>this.maximizeWindow(t)),d&&d.addEventListener("mousedown",n=>this.startResize(n,t)),t.addEventListener("mousedown",n=>{n.target.classList.contains("xp-control-btn")||this.bringWindowToFront(t)})}),document.addEventListener("mousemove",t=>{this.dragWindow(t),this.doResize(t)}),document.addEventListener("mouseup",()=>{this.endWindowDrag(),this.endResize()})}openWindow(t,e){if(t.classList.add("active"),t.style.display="flex",this.openWindows.add(e),this.windowStates[e]={open:!0,minimized:!1},this.bringWindowToFront(t),this.taskbarManager&&this.taskbarManager.addToTaskbar(e,t),this.windowPositions[e])this.restoreWindowPosition(t,e);else{const s={about:{width:750,height:800,left:300,top:20},contact:{width:500,height:550,left:950,top:120},project1:{width:600,height:420,left:180,top:80},project2:{width:600,height:420,left:220,top:120},project3:{width:600,height:420,left:260,top:160}}[e]||{width:500,height:400,left:100,top:100},o=20,a=document.querySelector(".xp-taskbar, .taskbar"),d=a?a.offsetHeight:20,n=t.innerWidth-o,r=t.innerHeight-o-d,c=s.width>n?n:s.width,h=s.height>r?r:s.height;t.style.width=c+"px",t.style.height=h+"px",t.style.left=s.left+"px",t.style.top=s.top+"px"}this.saveAllState()}closeWindow(t){const e=t.id.replace("window-",""),i=t.getBoundingClientRect();this.saveWindowPosition(e,{x:parseInt(t.style.left)||i.left,y:parseInt(t.style.top)||i.top,width:parseInt(t.style.width)||i.width,height:parseInt(t.style.height)||i.height}),t.classList.remove("active"),t.style.display="none",this.openWindows.delete(e),this.taskbarManager&&this.taskbarManager.removeFromTaskbar(e),this.windowStates[e]={open:!1,minimized:!1},this.saveAllState()}minimizeWindow(t){const e=t.id.replace("window-","");t.style.display="none",this.windowStates[e]={open:!0,minimized:!0},this.saveAllState()}restoreWindow(t){t.style.display="flex",this.bringWindowToFront(t);const e=t.id.replace("window-","");this.windowStates[e]={open:!0,minimized:!1},this.saveAllState()}maximizeWindow(t){t.dataset.maximized==="true"?(t.style.top=t.dataset.originalTop||"100px",t.style.left=t.dataset.originalLeft||"100px",t.style.width=t.dataset.originalWidth||"600px",t.style.height=t.dataset.originalHeight||"400px",t.dataset.maximized="false"):(t.dataset.originalTop=t.style.top,t.dataset.originalLeft=t.style.left,t.dataset.originalWidth=t.style.width,t.dataset.originalHeight=t.style.height,t.style.top="0px",t.style.left="0px",t.style.width="100vw",t.style.height="calc(100vh - 40px)",t.dataset.maximized="true");const e=t.id.replace("window-","");this.windowStates[e]={...this.windowStates[e],maximized:t.dataset.maximized==="true"},this.saveAllState()}startWindowDrag(t,e){if(e.dataset.maximized==="true")return;this.isDragging=!0,this.currentWindow=e,this.bringWindowToFront(e);const i=e.getBoundingClientRect();this.offset.x=t.clientX-i.left,this.offset.y=t.clientY-i.top,t.preventDefault()}dragWindow(t){if(!this.isDragging||!this.currentWindow)return;const e=t.clientX-this.offset.x,i=Math.max(0,t.clientY-this.offset.y);this.currentWindow.style.left=e+"px",this.currentWindow.style.top=i+"px"}endWindowDrag(){if(this.isDragging&&this.currentWindow){const t=this.currentWindow.id.replace("window-",""),e=this.currentWindow.getBoundingClientRect();this.saveWindowPosition(t,{x:parseInt(this.currentWindow.style.left),y:parseInt(this.currentWindow.style.top),width:e.width,height:e.height})}this.isDragging=!1,this.currentWindow=null,this.saveAllState()}startResize(t,e){if(e.dataset.maximized==="true")return;this.isResizing=!0,this.currentResizeWindow=e,this.bringWindowToFront(e);const i=e.getBoundingClientRect();this.resizeStartSize.width=i.width,this.resizeStartSize.height=i.height,this.resizeStartMouse.x=t.clientX,this.resizeStartMouse.y=t.clientY,t.preventDefault(),t.stopPropagation()}doResize(t){if(!this.isResizing||!this.currentResizeWindow)return;const e=this.currentResizeWindow,i=t.clientX-this.resizeStartMouse.x,s=t.clientY-this.resizeStartMouse.y;let o=this.resizeStartSize.width+i,a=this.resizeStartSize.height+s;const d=20,n=20;o=Math.max(200,Math.min(o,window.innerWidth-d)),a=Math.max(100,Math.min(a,window.innerHeight-d-n)),e.style.width=o+"px",e.style.height=a+"px"}endResize(){if(this.isResizing&&this.currentResizeWindow){const t=this.currentResizeWindow.id.replace("window-",""),e=this.currentResizeWindow.getBoundingClientRect();this.saveWindowPosition(t,{x:parseInt(this.currentResizeWindow.style.left),y:parseInt(this.currentResizeWindow.style.top),width:e.width,height:e.height})}this.isResizing=!1,this.currentResizeWindow=null,this.saveAllState()}bringWindowToFront(t){t.style.zIndex=++this.zIndexCounter,this.windows.forEach(e=>{e.querySelector(".xp-title-bar").classList.toggle("inactive",e!==t)}),this.saveZOrder()}centerWindow(t){const e=t.getBoundingClientRect(),i=(t.innerWidth-e.width)/2,s=(t.innerHeight-e.height)/2;t.style.left=Math.max(0,i)+"px",t.style.top=Math.max(0,s)+"px",this.saveAllState()}saveWindowPosition(t,e){this.windowPositions[t]=e,this.saveAllState()}restoreWindowPosition(t,e){if(this.windowPositions[e]){const i=this.windowPositions[e];t.style.left=i.x+"px",t.style.top=i.y+"px",i.width&&(t.style.width=i.width+"px"),i.height&&(t.style.height=i.height+"px"),t.classList.add("remembered-position")}}restoreZOrderAndBringToFront(){if(!this.zOrder||!this.zOrder.length)return;let t=100;this.zOrder.forEach(e=>{const i=document.getElementById("window-"+e);i&&i.classList.contains("active")&&i.style.display!=="none"&&(i.style.zIndex=++t)}),this.zIndexCounter=t}handleTaskbarClick(t){const e=document.getElementById("window-"+t);e&&(e.style.display==="none"&&this.restoreWindow(e),this.bringWindowToFront(e))}}class f{constructor(t="taskbar-items",e=null){this.taskbarItems=document.getElementById(t),this.draggedTaskbarItem=null,this.draggedWindowId=null,this.windowManager=e}addToTaskbar(t,e){if(this.taskbarItems.querySelector(`[data-window-id="${t}"]`))return;const i=document.createElement("div");i.className="xp-taskbar-item active",i.dataset.windowId=t;let s="Window";const o=document.querySelector(`[data-window="${t}"]`);if(o){const n=o.querySelector(".icon-label");n&&(s=n.textContent)}let a="";switch(t){case"about":a="${import.meta.env.BASE_URL}/assets/images/windows/window-about.png";break;case"contact":a="${import.meta.env.BASE_URL}/assets/images/windows/window-contact.png";break;case"project1":a="${import.meta.env.BASE_URL}/assets/images/windows/betabreak.png";break;case"project2":a="${import.meta.env.BASE_URL}/assets/images/windows/storme.png";break;case"project3":a="${import.meta.env.BASE_URL}/assets/images/icons/ai-ico.png";break;default:a=""}const d=a?`background-image: url('${a}'); background-size: contain; background-repeat: no-repeat; background-position: center;`:"";i.innerHTML=`
            <div style="width: 16px; height: 16px; ${a?"":"background: linear-gradient(45deg, #4A9EFF, #0054E3);"} border-radius: 2px; display: flex; align-items: center; justify-content: center; color: white; font-size: 8px; ${d}">
                ${a?"":"ðŸªŸ"}
            </div>
            ${s}
        `,i.draggable=!0,i.addEventListener("dragstart",n=>{n.dataTransfer.setData("text/plain",t),i.style.opacity="0",this.draggedTaskbarItem=i,this.draggedWindowId=t;const r=i.cloneNode(!0);r.style.position="fixed",r.style.top="-1000px",r.style.left="-1000px",r.style.zIndex="9999",r.style.pointerEvents="none",document.body.appendChild(r),n.dataTransfer.setDragImage(r,0,0),setTimeout(()=>{document.body.removeChild(r)},0)}),i.addEventListener("dragend",()=>{i.style.opacity="1",this.draggedTaskbarItem=null,this.draggedWindowId=null}),i.addEventListener("dragover",n=>{n.preventDefault(),this.draggedTaskbarItem&&this.draggedTaskbarItem!==i&&this.handleTaskbarDragOver(n,i)}),i.addEventListener("dragenter",n=>{n.preventDefault(),this.draggedTaskbarItem&&this.draggedTaskbarItem!==i&&this.handleTaskbarDragEnter(n,i)}),i.addEventListener("dragleave",n=>{n.preventDefault(),this.draggedTaskbarItem&&this.draggedTaskbarItem!==i&&this.handleTaskbarDragLeave(n,i)}),i.addEventListener("drop",n=>{n.preventDefault(),this.draggedTaskbarItem&&this.draggedTaskbarItem!==i&&this.handleTaskbarDrop(n,i)}),i.addEventListener("click",()=>{this.windowManager&&this.windowManager.handleTaskbarClick(t)}),this.taskbarItems.appendChild(i)}removeFromTaskbar(t){const e=this.taskbarItems.querySelector(`[data-window-id="${t}"]`);e&&this.taskbarItems.removeChild(e)}handleTaskbarDragOver(t,e){const i=e.getBoundingClientRect(),s=t.clientX,o=i.left+i.width/2;s<o?(e.style.borderLeft="2px solid #4A9EFF",e.style.borderRight=""):(e.style.borderRight="2px solid #4A9EFF",e.style.borderLeft="")}handleTaskbarDragEnter(t,e){e.style.backgroundColor="rgba(74, 158, 255, 0.2)"}handleTaskbarDragLeave(t,e){e.style.backgroundColor="",e.style.borderLeft="",e.style.borderRight=""}handleTaskbarDrop(t,e){const i=this.draggedWindowId,s=e.dataset.windowId;if(!i||!s||i===s)return;const o=this.taskbarItems.querySelector(`[data-window-id="${i}"]`);if(!o)return;const a=e.getBoundingClientRect(),d=t.clientX,n=a.left+a.width/2;d<n?this.taskbarItems.insertBefore(o,e):this.taskbarItems.insertBefore(o,e.nextSibling),e.style.backgroundColor="",e.style.borderLeft="",e.style.borderRight=""}}class y{constructor(t="#desktop"){this.desktop=document.querySelector(t),this.desktopIcons=this.desktop.querySelectorAll(".desktop-icon"),this.isDraggingIcon=!1,this.currentIcon=null,this.iconOffset={x:0,y:0},this.gridOrigin={x:20,y:20},this.gridSize=100,this.iconPositions={},this.init()}init(){this.loadIconPositions(),this.desktopIcons.forEach((t,e)=>{this.restoreIconPosition(t),t.addEventListener("click",()=>this.selectIcon(t)),t.addEventListener("dblclick",()=>this.handleIconDoubleClick(t)),t.addEventListener("mousedown",i=>{if(i.button!==0)return;const s=setTimeout(()=>{this.startIconDrag(i,t)},180),o=()=>{clearTimeout(s),window.removeEventListener("mouseup",o)};window.addEventListener("mouseup",o)}),t.style.cursor="pointer",t.style.userSelect="none"}),document.addEventListener("mousemove",t=>this.dragIcon(t)),document.addEventListener("mouseup",()=>this.endIconDrag())}loadIconPositions(){try{const t=localStorage.getItem("xp-icon-positions");this.iconPositions=t?JSON.parse(t):{}}catch{this.iconPositions={}}}saveIconPosition(t,e){this.iconPositions[t]=e;try{localStorage.setItem("xp-icon-positions",JSON.stringify(this.iconPositions))}catch{}}restoreIconPosition(t){const e=t.dataset.window||t.textContent;if(this.iconPositions[e]){const i=this.iconPositions[e];t.style.left=i.x+"px",t.style.top=i.y+"px"}}snapToGrid(t,e){const i=t-this.gridOrigin.x,s=e-this.gridOrigin.y,o=Math.round(i/this.gridSize)*this.gridSize,a=Math.round(s/this.gridSize)*this.gridSize;return{x:o+this.gridOrigin.x,y:a+this.gridOrigin.y}}startIconDrag(t,e){this.isDraggingIcon=!0,this.currentIcon=e;const i=e.getBoundingClientRect();this.desktop.getBoundingClientRect(),this.iconOffset.x=t.clientX-i.left,this.iconOffset.y=t.clientY-i.top,e.style.opacity="0.7",e.style.zIndex="1000",e.classList.add("dragging"),this.selectIcon(e),t.preventDefault()}dragIcon(t){if(!this.isDraggingIcon||!this.currentIcon)return;const e=this.desktop.getBoundingClientRect();let i=t.clientX-this.iconOffset.x-e.left,s=t.clientY-this.iconOffset.y-e.top;i=Math.max(0,Math.min(i,this.desktop.clientWidth-72)),s=Math.max(0,Math.min(s,this.desktop.clientHeight-72)),this.currentIcon.style.left=i+"px",this.currentIcon.style.top=s+"px"}endIconDrag(){if(!this.isDraggingIcon||!this.currentIcon)return;const t=this.currentIcon,e=parseInt(t.style.left)||0,i=parseInt(t.style.top)||0,s=this.snapToGrid(e,i);t.style.left=s.x+"px",t.style.top=s.y+"px";const o=t.dataset.window||t.textContent;this.saveIconPosition(o,s),t.style.opacity="",t.style.zIndex="",t.classList.remove("dragging"),this.isDraggingIcon=!1,this.currentIcon=null}selectIcon(t){this.desktopIcons.forEach(e=>e.classList.remove("selected")),t.classList.add("selected")}handleIconDoubleClick(t){const e=t.dataset.window,i=document.getElementById(`window-${e}`);i&&i.windowManager&&i.windowManager.openWindow(i,e)}}class b{constructor(t="#window-docviewer",e=null){this.window=document.querySelector(t),this.tabsBar=document.getElementById("docviewer-tabs"),this.contentArea=document.getElementById("docviewer-content"),this.zoomInBtn=document.getElementById("docviewer-zoom-in"),this.zoomOutBtn=document.getElementById("docviewer-zoom-out"),this.downloadBtn=document.getElementById("docviewer-download"),this.tabs=[],this.activeTab=null,this.zoom=1,this.windowManager=e,this.setupEvents(),this.restoreTabsFromStorage()}saveTabsToStorage(){const t=this.tabs.map(i=>({url:i.url,name:i.name,ext:i.ext})),e=this.activeTab?this.activeTab.url:null;localStorage.setItem("docviewer-tabs",JSON.stringify(t)),localStorage.setItem("docviewer-active-tab",e)}restoreTabsFromStorage(){const t=localStorage.getItem("docviewer-tabs"),e=localStorage.getItem("docviewer-active-tab");if(t)try{const i=JSON.parse(t);if(this.tabs=i.map(s=>({id:"tab-"+Date.now()+"-"+Math.random().toString(36).slice(2),...s})),this.renderTabs(),this.tabs.length>0){let s=this.tabs[0].id;if(e){const o=this.tabs.find(a=>a.url===e);o&&(s=o.id)}this.setActiveTab(s)}}catch{}}setupEvents(){this.zoomInBtn.addEventListener("click",()=>this.setZoom(this.zoom*1.2)),this.zoomOutBtn.addEventListener("click",()=>this.setZoom(this.zoom/1.2)),this.downloadBtn.addEventListener("click",()=>{this.activeTab&&window.open(this.activeTab.url,"_blank")})}openDoc(t,e,i=!1){const s=this.tabs.find(r=>r.url===t);if(s){this.setActiveTab(s.id),i||this.bringToFront();return}const o=t.split("/").pop(),a="tab-"+Date.now()+"-"+Math.random().toString(36).slice(2),d=t.split(".").pop().toLowerCase(),n={id:a,url:t,name:o,ext:d};this.tabs.push(n),this.renderTabs(),this.setActiveTab(a),this.saveTabsToStorage(),i||this.bringToFront()}setActiveTab(t){this.activeTab=this.tabs.find(e=>e.id===t),this.renderTabs(),this.renderContent(),this.saveTabsToStorage()}closeTab(t){const e=this.tabs.findIndex(i=>i.id===t);e!==-1&&(this.tabs.splice(e,1),this.activeTab&&this.activeTab.id===t?this.tabs.length>0?this.setActiveTab(this.tabs[Math.max(0,e-1)].id):(this.activeTab=null,this.renderTabs(),this.renderContent(),this.hide()):this.renderTabs(),this.saveTabsToStorage())}renderTabs(){this.tabsBar.innerHTML="",this.tabs.forEach(t=>{const e=document.createElement("div");e.className="docviewer-tab"+(this.activeTab&&t.id===this.activeTab.id?" active":""),e.textContent=t.name,e.title=t.url,e.style.padding="4px 12px",e.style.cursor="pointer",e.style.borderRight="1px solid #b5b5b5",e.style.background=this.activeTab&&t.id===this.activeTab.id?"#fff":"#e5e5e5",e.addEventListener("click",()=>this.setActiveTab(t.id));const i=document.createElement("span");i.textContent=" Ã—",i.style.marginLeft="8px",i.style.color="#888",i.style.cursor="pointer",i.addEventListener("click",s=>{s.stopPropagation(),this.closeTab(t.id)}),e.appendChild(i),this.tabsBar.appendChild(e)})}renderContent(){if(this.contentArea.innerHTML="",this.zoom=1,!this.activeTab)return;const{url:t,ext:e}=this.activeTab;if(["pdf"].includes(e)){const i=document.createElement("div");i.id="docviewer-pdf-container",i.style.width="100%",i.style.height="100%",this.contentArea.appendChild(i),this.renderPDF(t,this.zoom)}else if(["png","jpg","jpeg","gif","svg"].includes(e)){const i=document.createElement("img");i.src=t,i.style.maxWidth="100%",i.style.maxHeight="100%",i.style.transform=`scale(${this.zoom})`,i.onload=()=>{i.style.display="block"},this.contentArea.appendChild(i)}else{const i=document.createElement("a");i.href=t,i.textContent="Download "+this.activeTab.name,i.className="xp-button",i.download=this.activeTab.name,this.contentArea.appendChild(i)}}setZoom(t){if(this.zoom=Math.max(.2,Math.min(t,5)),!this.activeTab)return;const{ext:e}=this.activeTab;if(["pdf"].includes(e))this.renderPDF(this.activeTab.url,this.zoom);else if(["png","jpg","jpeg","gif","svg"].includes(e)){const i=this.contentArea.querySelector("img");i&&(i.style.transform=`scale(${this.zoom})`)}}renderPDF(t,e){if(!window.pdfjsLib){this.contentArea.innerHTML='<div style="color: #888;">PDF.js not loaded</div>';return}const i=this.contentArea.querySelector("#docviewer-pdf-container");i.innerHTML="",window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.worker.min.js",window.pdfjsLib.getDocument(t).promise.then(s=>{for(let o=1;o<=s.numPages;o++)s.getPage(o).then(a=>{const d=a.getViewport({scale:e}),n=document.createElement("canvas");n.width=d.width,n.height=d.height;const r=n.getContext("2d");a.render({canvasContext:r,viewport:d}).promise.then(()=>{i.appendChild(n)})})}).catch(s=>{i.innerHTML='<div style="color: #c00;">Failed to load PDF: '+s.message+"</div>"})}bringToFront(){this.windowManager?this.windowManager.openWindow(this.window,"docviewer"):(this.window.style.display="flex",this.window.style.zIndex=1e3)}hide(){this.window.style.display="none"}}function v(l,t){document.querySelectorAll("a.xp-button, a.docviewer-link").forEach(e=>{const i=e.getAttribute("href");i&&/\.(pdf|png|jpg|jpeg|gif|svg)$/i.test(i)&&e.addEventListener("click",s=>{s.preventDefault();const o=e.textContent.trim()||i.split("/").pop();l.openDoc(i,o),t?t.openWindow(l.window,"docviewer"):l.bringToFront()})})}class w{constructor(t="#contact-form"){this.form=document.querySelector(t),this.form&&this.form.addEventListener("submit",e=>this.handleContactFormSubmit(e))}handleContactFormSubmit(t){t.preventDefault(),alert("Message sent! (Demo)"),this.form.reset()}}document.addEventListener("DOMContentLoaded",()=>{document.body.style.background="",document.body.style.backgroundImage="url('/PortfolioSite/assets/images/backgrounds/desktop-background.png')",document.body.style.backgroundSize="cover",document.body.style.backgroundPosition="center center",document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundAttachment="fixed";const l=new f("taskbar-items",null),t=document.querySelectorAll(".xp-window"),e=new m(t,l);l.windowManager=e,new y;const i=new b(void 0,e);new w,t.forEach(n=>{n.windowManager=e});function s(){let n={};try{const r=localStorage.getItem("xp-window-states");n=r?JSON.parse(r):{}}catch{n={}}t.forEach(r=>{const c=r.id.replace("window-","");let h,g=!1;if(n.hasOwnProperty(c)){const p=n[c];h=p.open,g=p.minimized||!1}else h=c==="about"||c==="contact",g=!1;h?(e.openWindow(r,c),g&&(r.style.display="none",n[c]={open:!0,minimized:!0})):(r.classList.remove("active"),r.style.display="none",e.openWindows.delete(c))})}s(),e.restoreZOrder();function o(){const n=document.getElementById("xp-clock");if(!n)return;const c=new Date().toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0});n.textContent=c}o(),setInterval(o,1e3);const a=document.querySelector(".xp-start-button");a&&a.addEventListener("click",()=>{localStorage.clear(),location.reload()});const d=document.getElementById("contact-form");d&&d.addEventListener("submit",n=>{n.preventDefault();const r=new FormData(d),c=r.get("name"),h=r.get("email"),g=r.get("subject"),p=r.get("message"),u=`mailto:oemcgl@gmail.com?subject=${encodeURIComponent(g)}&body=${encodeURIComponent(`Name: ${c}
Email: ${h}

Message:
${p}`)}`;window.location.href=u,alert("Opening your email client to send the message!"),d.reset()}),document.addEventListener("keydown",n=>{if(n.key==="Escape"){const r=Array.from(t).filter(c=>c.classList.contains("active")&&c.style.display!=="none");if(r.length>0){const c=r.reduce((h,g)=>{const p=parseInt(h.style.zIndex||0),u=parseInt(g.style.zIndex||0);return p>u?h:g});e.closeWindow(c)}}}),v(i,e)});
